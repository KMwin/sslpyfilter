// ========================================================================================================================
// SslPyFilter
//
// Copyright ©2007-2008 Liam Kirton <liam@int3.ws>
// ========================================================================================================================
// SslBufferMap.h
//
// Created: 30/11/2007
// ========================================================================================================================

#pragma once

// ========================================================================================================================

#include <windows.h>

#include <map>

// ========================================================================================================================

class SslBufferMap
{
public:
	SslBufferMap();
	~SslBufferMap();

	static SslBufferMap *GetInstance();

	void Map(BSTR unencryptedBuffer, BSTR encryptedBuffer);
	BSTR Unmap(BSTR unencryptedBuffer, DWORD &startOffset, DWORD &endOffset);

private:
	void Lock();
	void Unlock();

	HANDLE hMutex_;
	std::map<BSTR, BSTR> bufferMap_;
};

// ========================================================================================================================
